<div class="card">
  <h1 class="text-3xl font-extrabold text-gray-800 mb-8 text-center">Subir Fotos de Evento</h1>

  <form id="uploadForm">
    <div class="mb-5">
      <!-- Selecci贸n de lbum -->
      <div id="albumSelectionMode">
        <label for="albumSelect" class="block text-gray-700 text-sm font-medium mb-2">Seleccionar lbum Existente:</label>
        <div class="select-with-clear">
          <button type="button" id="clearAlbumSelection" class="clear-album-selection-btn">
            <i class="fas fa-trash-alt"></i>
          </button>
          <select id="albumSelect" class="input-field mb-2">
            <option value="">Cargando 谩lbumes...</option>
          </select>
        </div>
        <small class="text-gray-500 block mb-4">O crea uno nuevo:</small>
        <button type="button" id="toggleCreateNewAlbumMode" class="btn-secondary mt-2">Crear Nuevo lbum</button>
      </div>

      <!-- Creaci贸n de nuevo lbum -->
    <div id="albumCreationMode" class="hidden">
      <label for="newAlbumNameInput" class="block text-gray-700 text-sm font-medium mb-2">Nombre del Nuevo lbum:</label>
      <input type="text" id="newAlbumNameInput" class="input-field" placeholder="Ej: Acto Fin de A帽o">

      <label for="newAlbumDateInput" class="block text-gray-700 text-sm font-medium mt-3 mb-2">Fecha del Evento:</label>
      <input type="text" id="newAlbumDescriptionInput" class="input-field" placeholder="Opcional">

      <input type="date" id="newAlbumDateInput" class="input-field">

      <label for="newAlbumDescriptionInput" class="block text-gray-700 text-sm font-medium mt-3 mb-2">Descripci贸n / Colegio:</label>
      <input type="text" id="newAlbumDescriptionInput" class="input-field" placeholder="Opcional">

      <div class="flex gap-2 mt-4">
        <button type="button" id="confirmCreateAlbumButton" class="btn-primary flex-grow">Confirmar Creaci贸n</button>
        <button type="button" id="cancelCreateAlbumButton" class="btn-secondary flex-grow">Cancelar</button>
      </div>
    </div>
    </div>

    <!-- Subida de fotos -->
    <div class="mb-6 hidden" id="photosUploadSection">
      <label class="block text-gray-700 text-sm font-medium mb-2">Seleccionar Fotos:</label>
      <!-- Archivos sueltos -->
      <input 
        type="file" 
        id="photos" 
        name="photos" 
        multiple 
        accept="image/*"
        class="input-field mb-3"
      />

      <!-- Carpeta completa (solo Chrome/Edge) -->
      <input 
        type="file" 
        id="photosFolder" 
        name="photos" 
        multiple 
        accept="image/*" 
        webkitdirectory 
        class="hidden"
      />

      <button type="button" id="selectFolderBtn" class="btn-secondary mt-2">
         Seleccionar carpeta completa
      </button>
      <div class="preview-grid" id="previewContainer"></div>
    </div>

    <button type="submit" id="uploadButton" class="btn-primary flex items-center justify-center hidden">
      <span id="loading-spinner" class="loading-spinner hidden"></span>
      Subir Fotos
    </button>

    <div id="loading" class="text-center mt-4 hidden">
      <span class="loading-spinner"></span> Subiendo fotos... Por favor, espera.
    </div>
    <div id="message" class="message hidden"></div>
  </form>
</div>

<!-- Gesti贸n de lbumes Existentes -->
<div class="mt-12">
  <div class="flex justify-between items-center mb-6">
    <button id="toggleAlbumsSection" class="flex items-center gap-2 text-2xl font-bold text-gray-800 hover:text-indigo-600 transition-colors">
      <i id="toggleAlbumsIcon" class="fas fa-chevron-down transition-transform"></i>
      <span>lbumes Existentes</span>
    </button>
    <button id="reloadAlbums" class="bg-green-500 hover:bg-green-600 text-white w-10 h-10 rounded flex items-center justify-center" title="Recargar p谩gina">
      <i class="fas fa-sync-alt"></i>
    </button>
  </div>
  
  <!-- Filtros -->
  <div id="albumsContent" class="hidden">
    <div class="flex gap-4 mb-6">
      <div class="flex-1">
        <input 
          type="text" 
          id="searchAlbumText" 
          placeholder=" Buscar por nombre, descripci贸n o colegio..." 
          class="input-field w-full"
        />
      </div>
      <div class="w-64">
        <input 
          type="date" 
          id="filterAlbumDate" 
          placeholder="Filtrar por fecha" 
          class="input-field w-full"
        />
      </div>
    </div>

    <div id="albumsList" class="space-y-8">
      <p class="text-gray-500">Cargando 谩lbumes...</p>
    </div>
  </div>
</div>

<!-- Modal Editar lbum -->
<div id="editAlbumModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-lg w-96 shadow-lg">
    <h3 class="text-lg font-bold mb-4">Editar lbum</h3>
    <label class="block text-sm font-medium text-gray-700">Nombre</label>
    <input type="text" id="editAlbumName" class="input-field mb-3" placeholder="Nombre del 谩lbum">

    <label class="block text-sm font-medium text-gray-700">Fecha del Evento</label>
    <input type="date" id="editAlbumDate" class="input-field mb-3">

    <label class="block text-sm font-medium text-gray-700">Descripci贸n / Colegio</label>
    <input type="text" id="editAlbumDescription" class="input-field mb-3" placeholder="Opcional">

    <div class="flex justify-end gap-2">
      <button id="cancelEditAlbum" class="btn-secondary">Cancelar</button>
      <button id="saveEditAlbum" class="btn-primary">Guardar</button>
    </div>
  </div>
</div>

